# 다국어 지원 테스트 시나리오

## 테스트 개요
IP 기반 언어 감지 구현 전후의 다국어 지원 기능을 체계적으로 테스트하기 위한 시나리오입니다.

## 테스트 환경 구성

### 1. 로컬 개발 환경
```bash
# 개발 서버 실행
npm run dev

# 테스트 포트 확인
# http://localhost:3000
```

### 2. 테스트 도구 준비
- **브라우저**: Chrome, Firefox, Safari (시크릿 모드)
- **VPN**: VPN Gate, ProtonVPN, 또는 기타 신뢰할 수 있는 VPN
- **개발자 도구**: Network, Application, Console 탭
- **curl**: 명령줄 HTTP 클라이언트

### 3. 테스트 계정
- 테스트용 계정 생성 (각 언어별)
- 쿠키 및 로컬 스토리지 초기화 방법 확인

## 현재 구현 테스트 (기준선)

### TC-01: 기본 URL 라우팅 테스트
**목적**: 현재 URL 기반 라우팅 동작 확인

**테스트 케이스**:
1. `http://localhost:3000` 접속
   - **예상**: `/ko/`로 리다이렉트
   - **검증**: URL 주소창, 페이지 언어 확인

2. `http://localhost:3000/en` 접속
   - **예상**: 영어 페이지 표시
   - **검증**: 페이지 내 텍스트 언어 확인

3. `http://localhost:3000/ja` 접속
   - **예상**: 일본어 페이지 표시
   - **검증**: 페이지 내 텍스트 언어 확인

4. `http://localhost:3000/jp` 접속
   - **예상**: `/ja/`로 리다이렉트
   - **검증**: 별칭 처리 동작 확인

### TC-02: 번역 파일 완전성 테스트
**목적**: 모든 번역 키가 각 언어에 존재하는지 확인

**테스트 케이스**:
1. 한국어 페이지 순회
   - 메인 페이지, 로그인, 회원가입, 앱, 설정 페이지
   - 누락된 번역 키 확인

2. 영어 페이지 순회
   - 동일한 페이지들 확인
   - 한국어와 동일한 구조 확인

3. 일본어 페이지 순회
   - 동일한 페이지들 확인
   - 폰트 적용 상태 확인

### TC-03: 언어 전환 기능 테스트
**목적**: 언어 전환 UI 동작 확인

**테스트 케이스**:
1. 언어 선택 드롭다운/버튼 존재 여부
2. 언어 변경 시 URL 변경 확인
3. 언어 변경 시 페이지 콘텐츠 변경 확인
4. 언어 변경 후 새로고침 시 언어 유지 확인

## 브라우저 언어 감지 테스트

### TC-04: Accept-Language 헤더 테스트
**목적**: 브라우저 언어 설정에 따른 자동 감지 확인

**테스트 케이스**:
1. **영어 브라우저 시뮬레이션**
   ```bash
   curl -H "Accept-Language: en-US,en;q=0.9" http://localhost:3000
   ```
   - **예상**: 영어 페이지 또는 `/en/`로 리다이렉트
   - **현재**: `/ko/`로 리다이렉트 (localeDetection: false)

2. **일본어 브라우저 시뮬레이션**
   ```bash
   curl -H "Accept-Language: ja-JP,ja;q=0.9" http://localhost:3000
   ```
   - **예상**: 일본어 페이지 또는 `/ja/`로 리다이렉트
   - **현재**: `/ko/`로 리다이렉트

3. **다중 언어 우선순위 테스트**
   ```bash
   curl -H "Accept-Language: ja-JP,ja;q=0.9,en-US;q=0.8,ko;q=0.7" http://localhost:3000
   ```
   - **예상**: 일본어 페이지 (가장 높은 우선순위)

### TC-05: 브라우저 설정 변경 테스트
**목적**: 실제 브라우저 언어 설정 변경 시 동작 확인

**테스트 케이스**:
1. Chrome 언어 설정 변경
   - 설정 → 고급 → 언어 → 영어/일본어 추가 및 우선순위 변경
   - 시크릿 모드로 사이트 접속
   - 자동 언어 감지 확인

2. Firefox 언어 설정 변경
   - about:config → intl.accept_languages 변경
   - 시크릿 모드로 사이트 접속
   - 자동 언어 감지 확인

## IP 기반 지역 감지 테스트

### TC-06: VPN 환경 테스트
**목적**: 실제 해외 IP에서의 언어 감지 확인

**테스트 전 준비**:
1. VPN 연결 전 현재 IP 확인: https://whatismyipaddress.com/
2. 브라우저 쿠키 및 로컬 스토리지 초기화
3. 시크릿 모드 사용

**테스트 케이스**:
1. **일본 VPN 테스트**
   - VPN Gate에서 일본 서버 연결
   - IP 주소 확인 (JP 국가 코드 확인)
   - 시크릿 모드로 사이트 접속
   - **예상**: `/ja/`로 자동 리다이렉트
   - **현재**: `/ko/`로 리다이렉트

2. **미국 VPN 테스트**
   - VPN Gate에서 미국 서버 연결
   - IP 주소 확인 (US 국가 코드 확인)
   - 시크릿 모드로 사이트 접속
   - **예상**: `/en/`로 자동 리다이렉트
   - **현재**: `/ko/`로 리다이렉트

3. **영국 VPN 테스트**
   - VPN Gate에서 영국 서버 연결
   - IP 주소 확인 (GB 국가 코드 확인)
   - 시크릿 모드로 사이트 접속
   - **예상**: `/en/`로 자동 리다이렉트
   - **현재**: `/ko/`로 리다이렉트

### TC-07: 모의 지역 테스트 (개발 환경)
**목적**: 개발 환경에서 IP 기반 감지 로직 테스트

**테스트 케이스**:
1. **모의 헤더 테스트**
   ```bash
   # 일본 IP 시뮬레이션
   curl -H "X-Mock-Country: JP" http://localhost:3000
   
   # 미국 IP 시뮬레이션
   curl -H "X-Mock-Country: US" http://localhost:3000
   
   # 영국 IP 시뮬레이션
   curl -H "X-Mock-Country: GB" http://localhost:3000
   ```

2. **개발자 도구 네트워크 시뮬레이션**
   - Chrome DevTools → Network → 조건 설정
   - 사용자 에이전트 변경
   - 지역 설정 시뮬레이션

## 언어 감지 우선순위 테스트

### TC-08: 언어 감지 우선순위 검증
**목적**: 구현된 언어 감지 우선순위 로직 확인

**테스트 시나리오**:
1. **URL 경로 우선순위 테스트**
   - 일본 IP + 영어 브라우저 환경에서 `/en/` 접속
   - **예상**: 영어 페이지 유지 (URL 우선순위 높음)

2. **쿠키 우선순위 테스트**
   - 쿠키에 `NEXT_LOCALE=ja` 설정
   - 미국 IP에서 접속
   - **예상**: 일본어 페이지 (쿠키 우선순위)

3. **IP vs 브라우저 언어 우선순위 테스트**
   - 일본 IP + 영어 브라우저 설정
   - **예상**: 구현된 우선순위에 따른 결과

### TC-09: 폴백 전략 테스트
**목적**: 언어 감지 실패 시 폴백 동작 확인

**테스트 케이스**:
1. **지원하지 않는 언어 요청**
   ```bash
   curl -H "Accept-Language: de-DE,de;q=0.9" http://localhost:3000
   ```
   - **예상**: 기본 언어(ko) 또는 영어로 폴백

2. **잘못된 IP 정보**
   - 지역 감지 API 오류 시뮬레이션
   - **예상**: 다음 우선순위 방법으로 폴백

3. **네트워크 오류 시뮬레이션**
   - IP 조회 API 타임아웃
   - **예상**: 브라우저 언어 또는 기본 언어로 폴백

## 성능 테스트

### TC-10: 응답 시간 테스트
**목적**: 언어 감지 로직이 성능에 미치는 영향 측정

**테스트 케이스**:
1. **기준선 측정** (현재 구현)
   ```bash
   # 10회 연속 요청 시간 측정
   for i in {1..10}; do
     curl -w "%{time_total}\n" -o /dev/null -s http://localhost:3000
   done
   ```

2. **IP 감지 로직 추가 후 측정**
   - 동일한 방법으로 응답 시간 측정
   - 성능 차이 분석

3. **캐싱 효과 테스트**
   - 동일 IP에서 연속 요청 시 캐싱 효과 확인
   - 첫 번째 요청 vs 이후 요청 시간 비교

### TC-11: 동시 접속 테스트
**목적**: 다수 사용자 동시 접속 시 성능 확인

**테스트 케이스**:
1. **부하 테스트**
   ```bash
   # Apache Bench 사용
   ab -n 100 -c 10 http://localhost:3000/
   ```

2. **다양한 지역 동시 접속**
   - 여러 VPN 연결로 동시 접속 시뮬레이션
   - 서버 리소스 사용량 모니터링

## 사용자 경험 테스트

### TC-12: 사용자 시나리오 테스트
**목적**: 실제 사용자 관점에서의 언어 감지 경험 확인

**테스트 시나리오**:
1. **해외 거주 한국인 사용자**
   - 미국 IP + 한국어 브라우저 설정
   - **예상**: 한국어 페이지 표시
   - **확인**: 사용자 의도와 일치하는지 검증

2. **일본 거주 외국인 사용자**
   - 일본 IP + 영어 브라우저 설정
   - **예상**: 영어 페이지 표시 (브라우저 언어 우선)
   - **확인**: 사용자 의도와 일치하는지 검증

3. **여행 중인 사용자**
   - 다양한 국가 IP에서 접속
   - 언어 설정 유지 여부 확인
   - 쿠키 기반 언어 기억 기능 테스트

### TC-13: 접근성 테스트
**목적**: 언어 변경 기능의 접근성 확인

**테스트 케이스**:
1. **키보드 네비게이션**
   - Tab 키로 언어 선택 UI 접근 가능 여부
   - Enter/Space 키로 언어 변경 가능 여부

2. **스크린 리더 지원**
   - 언어 변경 버튼의 적절한 레이블 제공
   - 언어 변경 후 변경 사실 안내

3. **고대비 모드**
   - 고대비 모드에서 언어 선택 UI 가시성 확인

## 테스트 결과 문서화

### 테스트 결과 기록 템플릿
```markdown
## 테스트 결과: [TC-XX]

**테스트 일시**: YYYY-MM-DD HH:MM
**테스트 환경**: [로컬/스테이징/프로덕션]
**테스트 수행자**: [이름]

### 테스트 케이스
- **목적**: [테스트 목적]
- **절차**: [테스트 절차]
- **예상 결과**: [예상 결과]

### 실제 결과
- **결과**: [실제 결과]
- **상태**: [통과/실패/보류]
- **스크린샷**: [필요시 첨부]

### 발견된 이슈
- **이슈 내용**: [이슈 설명]
- **재현 방법**: [재현 절차]
- **우선순위**: [높음/중간/낮음]

### 추가 메모
[기타 관찰 사항이나 개선 제안]
```

### 회귀 테스트 체크리스트
- [ ] 기본 URL 라우팅 동작
- [ ] 번역 파일 완전성
- [ ] 언어 전환 기능
- [ ] 성능 저하 없음
- [ ] 기존 기능 정상 동작

## 배포 전 필수 테스트

### 스테이징 환경 테스트
1. 실제 지역 감지 동작 확인
2. 성능 모니터링
3. 에러 로그 확인
4. 사용자 피드백 수집

### 프로덕션 배포 후 모니터링
1. 실시간 언어 감지 정확도
2. 서버 리소스 사용량
3. 사용자 이탈률 변화
4. 언어 변경 클릭률

## 자동화 테스트 스크립트

### 기본 테스트 스크립트
```bash
#!/bin/bash
# test-i18n.sh

BASE_URL="http://localhost:3000"

echo "=== 다국어 지원 테스트 시작 ==="

# TC-01: 기본 라우팅 테스트
echo "1. 기본 라우팅 테스트"
curl -I $BASE_URL | grep -i location

# TC-04: Accept-Language 헤더 테스트
echo "2. 영어 브라우저 시뮬레이션"
curl -H "Accept-Language: en-US,en;q=0.9" -I $BASE_URL | grep -i location

echo "3. 일본어 브라우저 시뮬레이션"
curl -H "Accept-Language: ja-JP,ja;q=0.9" -I $BASE_URL | grep -i location

# TC-10: 성능 테스트
echo "4. 응답 시간 측정"
for i in {1..5}; do
  curl -w "%{time_total}\n" -o /dev/null -s $BASE_URL
done

echo "=== 테스트 완료 ==="
```

이 테스트 시나리오를 통해 현재 구현 상태를 확인하고, IP 기반 언어 감지 구현 후 개선된 기능을 체계적으로 검증할 수 있습니다.